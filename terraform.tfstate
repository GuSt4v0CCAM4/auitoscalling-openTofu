{"version":4,"terraform_version":"1.10.6","serial":206,"lineage":"7f8596ba-daa4-2cd2-4b4c-327507f4651b","outputs":{"access_urls":{"value":{"direct_server":"http://23.251.151.172:30080","load_balancer":"http://34.36.173.120"},"type":["object",{"direct_server":"string","load_balancer":"string"}]},"app_key":{"value":"base64:NTRkNDcyZDFmMWU2OWY3YmZhZGM4ZjVjMjY2Yjc1NzYxNmFkNjRlNGVlYjdlNzdmZjQ5ZWVmNjIyYzVmN2E1Yw==","type":"string","sensitive":true},"autoscaler_status":{"value":"https://console.cloud.google.com/compute/autoscalers?project=cloudcomputingunsa","type":"string"},"db_password":{"value":"_2K1_KB#(E2gb!C)gRpR@\u0026@D","type":"string","sensitive":true},"deployment_summary":{"value":{"application":"Coarlumini (Laravel + Vue.js + MySQL)","cluster_name":"K3s Coarlumini Cluster","load_balancer":"web-forwarding-rule","master_node":"k3s-master-server","max_workers":5,"min_workers":2,"worker_group":"web-group-manager"},"type":["object",{"application":"string","cluster_name":"string","load_balancer":"string","master_node":"string","max_workers":"number","min_workers":"number","worker_group":"string"}]},"instance_group_url":{"value":"https://console.cloud.google.com/compute/instanceGroups?project=cloudcomputingunsa","type":"string"},"k3s_server_internal_ip":{"value":"10.0.1.2","type":"string"},"k3s_server_ip":{"value":"23.251.151.172","type":"string"},"k3s_token":{"value":"lxp5Mrvr473HEeEVFePEIfYCDXvkQ1gaIQbhWL8zlfDo6qBzraH2l2d06sSgOiQ4","type":"string","sensitive":true},"kubectl_config_command":{"value":"gcloud compute ssh k3s-master-server --zone=us-central1-a --project=cloudcomputingunsa --command='sudo cat /etc/rancher/k3s/k3s.yaml' | sed 's/127.0.0.1/23.251.151.172/g' \u003e kubeconfig.yaml \u0026\u0026 export KUBECONFIG=./kubeconfig.yaml","type":"string"},"load_balancer_ip":{"value":"34.36.173.120","type":"string"},"manifests_bucket":{"value":"cloudcomputingunsa-k8s-9175ad57","type":"string"},"ssh_commands":{"value":{"k3s_server":"gcloud compute ssh k3s-master-server --zone=us-central1-a --project=cloudcomputingunsa"},"type":["object",{"k3s_server":"string"}]}},"resources":[{"mode":"managed","type":"google_compute_autoscaler","name":"web_autoscaler","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"autoscaling_policy":[{"cooldown_period":60,"cpu_utilization":[{"predictive_method":"NONE","target":0.6}],"load_balancing_utilization":[{"target":0.6}],"max_replicas":5,"metric":[],"min_replicas":2,"mode":"ON","scale_in_control":[],"scaling_schedules":[]}],"creation_timestamp":"2025-11-06T00:05:20.856-08:00","description":"","id":"projects/cloudcomputingunsa/zones/us-central1-a/autoscalers/web-autoscaler","name":"web-autoscaler","project":"cloudcomputingunsa","self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/zones/us-central1-a/autoscalers/web-autoscaler","target":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/zones/us-central1-a/instanceGroupManagers/web-group-manager","timeouts":null,"zone":"us-central1-a"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19","dependencies":["google_compute_health_check.autohealing","google_compute_instance.k3s_server","google_compute_instance_group_manager.web_group","google_compute_instance_template.web_template","google_compute_network.autoscale_network","google_compute_subnetwork.autoscale_subnet","google_service_account.k3s_sa","google_storage_bucket.k8s_manifests","google_storage_bucket_object.k8s_manifests","random_id.app_key","random_id.bucket_suffix","random_password.db_password","random_password.k3s_token"]}]},{"mode":"managed","type":"google_compute_backend_service","name":"web_backend","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":1,"attributes":{"affinity_cookie_ttl_sec":0,"backend":[{"balancing_mode":"UTILIZATION","capacity_scaler":1,"description":"","group":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/zones/us-central1-a/instanceGroups/web-group-manager","max_connections":0,"max_connections_per_endpoint":0,"max_connections_per_instance":0,"max_rate":0,"max_rate_per_endpoint":0,"max_rate_per_instance":0,"max_utilization":0.8}],"cdn_policy":[],"circuit_breakers":[],"compression_mode":"","connection_draining_timeout_sec":300,"consistent_hash":[],"creation_timestamp":"2025-11-06T00:05:20.834-08:00","custom_request_headers":null,"custom_response_headers":null,"description":"","edge_security_policy":"","enable_cdn":false,"fingerprint":"hemCadOBmek=","generated_id":4420962067379513391,"health_checks":["projects/cloudcomputingunsa/global/healthChecks/autohealing-health-check"],"iap":[],"id":"projects/cloudcomputingunsa/global/backendServices/web-backend-service","load_balancing_scheme":"EXTERNAL","locality_lb_policies":[],"locality_lb_policy":"","log_config":[{"enable":true,"sample_rate":1}],"name":"web-backend-service","outlier_detection":[],"port_name":"http","project":"cloudcomputingunsa","protocol":"HTTP","security_policy":"","security_settings":[],"self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/backendServices/web-backend-service","service_lb_policy":"","session_affinity":"NONE","timeout_sec":30,"timeouts":null},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9","dependencies":["google_compute_health_check.autohealing","google_compute_instance.k3s_server","google_compute_instance_group_manager.web_group","google_compute_instance_template.web_template","google_compute_network.autoscale_network","google_compute_subnetwork.autoscale_subnet","google_service_account.k3s_sa","google_storage_bucket.k8s_manifests","google_storage_bucket_object.k8s_manifests","random_id.app_key","random_id.bucket_suffix","random_password.db_password","random_password.k3s_token"]}]},{"mode":"managed","type":"google_compute_firewall","name":"k3s_internal","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":1,"attributes":{"allow":[{"ports":["6443","10250","2379-2380"],"protocol":"tcp"},{"ports":["8472","51820","51821"],"protocol":"udp"}],"creation_timestamp":"2025-11-06T00:03:19.753-08:00","deny":[],"description":"","destination_ranges":[],"direction":"INGRESS","disabled":false,"enable_logging":null,"id":"projects/cloudcomputingunsa/global/firewalls/k3s-internal-firewall","log_config":[],"name":"k3s-internal-firewall","network":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/networks/autoscale-network","priority":1000,"project":"cloudcomputingunsa","self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/firewalls/k3s-internal-firewall","source_ranges":["10.0.1.0/24"],"source_service_accounts":null,"source_tags":null,"target_service_accounts":null,"target_tags":["k3s-agent","k3s-server"],"timeouts":null},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9","dependencies":["google_compute_network.autoscale_network"]}]},{"mode":"managed","type":"google_compute_firewall","name":"web","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":1,"attributes":{"allow":[{"ports":["80","443","22","6443","30000-32767"],"protocol":"tcp"}],"creation_timestamp":"2025-11-06T00:03:19.536-08:00","deny":[],"description":"","destination_ranges":[],"direction":"INGRESS","disabled":false,"enable_logging":null,"id":"projects/cloudcomputingunsa/global/firewalls/web-firewall","log_config":[],"name":"web-firewall","network":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/networks/autoscale-network","priority":1000,"project":"cloudcomputingunsa","self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/firewalls/web-firewall","source_ranges":["0.0.0.0/0"],"source_service_accounts":null,"source_tags":null,"target_service_accounts":null,"target_tags":["http-server","k3s-agent","k3s-server"],"timeouts":null},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9","dependencies":["google_compute_network.autoscale_network"]}]},{"mode":"managed","type":"google_compute_global_forwarding_rule","name":"web_forwarding","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"base_forwarding_rule":"","description":"","effective_labels":{},"id":"projects/cloudcomputingunsa/global/forwardingRules/web-forwarding-rule","ip_address":"34.36.173.120","ip_protocol":"TCP","ip_version":"","label_fingerprint":"42WmSpB8rSM=","labels":null,"load_balancing_scheme":"EXTERNAL","metadata_filters":[],"name":"web-forwarding-rule","network":"","no_automate_dns_zone":null,"port_range":"80-80","project":"cloudcomputingunsa","psc_connection_id":"","psc_connection_status":"","self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/forwardingRules/web-forwarding-rule","service_directory_registrations":[],"source_ip_ranges":null,"subnetwork":"","target":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/targetHttpProxies/web-proxy","terraform_labels":{},"timeouts":null},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19","dependencies":["google_compute_backend_service.web_backend","google_compute_health_check.autohealing","google_compute_instance.k3s_server","google_compute_instance_group_manager.web_group","google_compute_instance_template.web_template","google_compute_network.autoscale_network","google_compute_subnetwork.autoscale_subnet","google_compute_target_http_proxy.web_proxy","google_compute_url_map.web_url_map","google_service_account.k3s_sa","google_storage_bucket.k8s_manifests","google_storage_bucket_object.k8s_manifests","random_id.app_key","random_id.bucket_suffix","random_password.db_password","random_password.k3s_token"]}]},{"mode":"managed","type":"google_compute_health_check","name":"autohealing","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"check_interval_sec":5,"creation_timestamp":"2025-11-06T00:02:56.950-08:00","description":"","grpc_health_check":[],"healthy_threshold":2,"http2_health_check":[],"http_health_check":[{"host":"","port":80,"port_name":"","port_specification":"","proxy_header":"NONE","request_path":"/","response":""}],"https_health_check":[],"id":"projects/cloudcomputingunsa/global/healthChecks/autohealing-health-check","log_config":[{"enable":false}],"name":"autohealing-health-check","project":"cloudcomputingunsa","self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/healthChecks/autohealing-health-check","source_regions":null,"ssl_health_check":[],"tcp_health_check":[],"timeout_sec":5,"timeouts":null,"type":"HTTP","unhealthy_threshold":3},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19"}]},{"mode":"managed","type":"google_compute_instance","name":"k3s_server","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":6,"attributes":{"advanced_machine_features":[],"allow_stopping_for_update":null,"attached_disk":[],"boot_disk":[{"auto_delete":true,"device_name":"persistent-disk-0","disk_encryption_key_raw":"","disk_encryption_key_sha256":"","initialize_params":[{"enable_confidential_compute":false,"image":"https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/images/ubuntu-2204-jammy-v20251023","labels":{},"provisioned_iops":0,"provisioned_throughput":0,"resource_manager_tags":null,"size":50,"storage_pool":"","type":"pd-ssd"}],"kms_key_self_link":"","mode":"READ_WRITE","source":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/zones/us-central1-a/disks/k3s-master-server"}],"can_ip_forward":false,"confidential_instance_config":[],"cpu_platform":"Intel Broadwell","current_status":"RUNNING","deletion_protection":false,"description":"","desired_status":null,"effective_labels":{},"enable_display":false,"guest_accelerator":[],"hostname":"","id":"projects/cloudcomputingunsa/zones/us-central1-a/instances/k3s-master-server","instance_id":"1531064889582413963","label_fingerprint":"42WmSpB8rSM=","labels":null,"machine_type":"e2-medium","metadata":{"app-key":"base64:NTRkNDcyZDFmMWU2OWY3YmZhZGM4ZjVjMjY2Yjc1NzYxNmFkNjRlNGVlYjdlNzdmZjQ5ZWVmNjIyYzVmN2E1Yw==","bucket-name":"cloudcomputingunsa-k8s-9175ad57","db-password":"_2K1_KB#(E2gb!C)gRpR@\u0026@D","enable-oslogin":"TRUE","k3s-token":"lxp5Mrvr473HEeEVFePEIfYCDXvkQ1gaIQbhWL8zlfDo6qBzraH2l2d06sSgOiQ4","project-id":"cloudcomputingunsa"},"metadata_fingerprint":"lYiUTYlF6iM=","metadata_startup_script":"#!/bin/bash\nset -e\n\n# ============================================\n# K3S SERVER INITIALIZATION SCRIPT\n# ============================================\n# Este script se ejecuta autom√°ticamente cuando\n# se crea la instancia del servidor K3s (master)\n# ============================================\n\nlog() { echo \"[$(date +'%Y-%m-%d %H:%M:%S')] $*\"; }\nerror() { echo \"[$(date +'%Y-%m-%d %H:%M:%S')] ERROR: $*\" \u003e\u00262; }\n\nlog \"=== Iniciando configuraci√≥n del servidor K3s ===\"\n\n# ============================================\n# OBTENER METADATA DE GCP\n# ============================================\n\nlog \"Obteniendo metadata de GCP...\"\nK3S_TOKEN=$(curl -s -H \"Metadata-Flavor: Google\" http://metadata.google.internal/computeMetadata/v1/instance/attributes/k3s-token)\nDB_PASSWORD=$(curl -s -H \"Metadata-Flavor: Google\" http://metadata.google.internal/computeMetadata/v1/instance/attributes/db-password)\nAPP_KEY=$(curl -s -H \"Metadata-Flavor: Google\" http://metadata.google.internal/computeMetadata/v1/instance/attributes/app-key)\nPROJECT_ID=$(curl -s -H \"Metadata-Flavor: Google\" http://metadata.google.internal/computeMetadata/v1/instance/attributes/project-id)\nBUCKET_NAME=$(curl -s -H \"Metadata-Flavor: Google\" http://metadata.google.internal/computeMetadata/v1/instance/attributes/bucket-name)\n\n# ============================================\n# ACTUALIZAR SISTEMA\n# ============================================\n\nlog \"Actualizando sistema operativo...\"\nexport DEBIAN_FRONTEND=noninteractive\napt-get update -y\napt-get upgrade -y -o Dpkg::Options::=\"--force-confold\"\n\n# ============================================\n# INSTALAR PAQUETES NECESARIOS\n# ============================================\n\nlog \"Instalando paquetes necesarios...\"\napt-get install -y \\\n    curl \\\n    wget \\\n    git \\\n    jq \\\n    nfs-common \\\n    ca-certificates \\\n    gnupg \\\n    lsb-release\n\n# ============================================\n# INSTALAR DOCKER\n# ============================================\n\nlog \"Instalando Docker...\"\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsh get-docker.sh\nrm get-docker.sh\n\n# Iniciar Docker\nsystemctl enable docker\nsystemctl start docker\n\n# Verificar instalaci√≥n\ndocker --version || error \"Docker no se instal√≥ correctamente\"\n\n# ============================================\n# CONFIGURAR DOCKER PARA GCR\n# ============================================\n\nlog \"Configurando Docker para Google Container Registry...\"\ngcloud auth configure-docker gcr.io --quiet\n\n# ============================================\n# INSTALAR K3S SERVER\n# ============================================\n\nlog \"Instalando K3s server (master node)...\"\ncurl -sfL https://get.k3s.io | INSTALL_K3S_EXEC=\"server \\\n    --write-kubeconfig-mode=644 \\\n    --disable=traefik \\\n    --tls-san=$(curl -s -H \"Metadata-Flavor: Google\" http://metadata.google.internal/computeMetadata/v1/instance/network-interfaces/0/access-configs/0/external-ip) \\\n    --bind-address=0.0.0.0 \\\n    --advertise-address=$(curl -s -H \"Metadata-Flavor: Google\" http://metadata.google.internal/computeMetadata/v1/instance/network-interfaces/0/ip) \\\n    --node-taint=CriticalAddonsOnly=true:NoExecute\" \\\n    K3S_TOKEN=\"$K3S_TOKEN\" \\\n    sh -\n\n# ============================================\n# ESPERAR A QUE K3S EST√â LISTO\n# ============================================\n\nlog \"Esperando a que K3s est√© completamente listo...\"\ntimeout=300\nelapsed=0\n\nuntil kubectl get nodes 2\u003e/dev/null | grep -q \"Ready\"; do\n    if [ $elapsed -ge $timeout ]; then\n        error \"K3s no se inici√≥ correctamente en $timeout segundos\"\n        journalctl -u k3s -n 50\n        exit 1\n    fi\n    sleep 5\n    elapsed=$((elapsed + 5))\n    log \"Esperando K3s... ($elapsed/$timeout segundos)\"\ndone\n\nlog \"‚úì K3s server est√° listo!\"\n\n# ============================================\n# CONFIGURAR KUBECTL\n# ============================================\n\nlog \"Configurando kubectl para usuarios...\"\n\n# Para root\nmkdir -p /root/.kube\ncp /etc/rancher/k3s/k3s.yaml /root/.kube/config\nchmod 600 /root/.kube/config\n\n# Para usuario ubuntu (si existe)\nif [ -d /home/ubuntu ]; then\n    mkdir -p /home/ubuntu/.kube\n    cp /etc/rancher/k3s/k3s.yaml /home/ubuntu/.kube/config\n    chown -R ubuntu:ubuntu /home/ubuntu/.kube\n    chmod 600 /home/ubuntu/.kube/config\nfi\n\n# ============================================\n# INSTALAR HELM\n# ============================================\n\nlog \"Instalando Helm...\"\ncurl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash\nhelm version || error \"Helm no se instal√≥ correctamente\"\n\n# ============================================\n# INSTALAR NGINX INGRESS CONTROLLER\n# ============================================\n\nlog \"Instalando nginx ingress controller...\"\nkubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.8.2/deploy/static/provider/cloud/deploy.yaml\n\n# Esperar a que el ingress controller est√© listo\nlog \"Esperando a que el ingress controller est√© listo...\"\nkubectl wait --namespace ingress-nginx \\\n  --for=condition=ready pod \\\n  --selector=app.kubernetes.io/component=controller \\\n  --timeout=300s || log \"‚ö† Timeout esperando ingress controller (puede seguir inicializ√°ndose)\"\n\n# ============================================\n# CREAR NAMESPACE COARLUMINI\n# ============================================\n\nlog \"Creando namespace coarlumini...\"\nkubectl create namespace coarlumini || log \"Namespace ya existe\"\n\n# ============================================\n# DESCARGAR MANIFIESTOS K8S DESDE GCS\n# ============================================\n\nlog \"Descargando manifiestos de Kubernetes desde GCS...\"\nmkdir -p /root/k8s-manifests\ngsutil -m cp -r \"gs://${BUCKET_NAME}/*\" /root/k8s-manifests/\n\nlog \"‚úì Manifiestos descargados: $(ls -1 /root/k8s-manifests/ | wc -l) archivos\"\n\n# ============================================\n# CREAR SECRETS DE COARLUMINI\n# ============================================\n\nlog \"Creando secrets para Coarlumini...\"\ncat \u003c\u003cEOF | kubectl apply -f -\napiVersion: v1\nkind: Secret\nmetadata:\n  name: coarlumini-secrets\n  namespace: coarlumini\ntype: Opaque\nstringData:\n  APP_KEY: \"${APP_KEY}\"\n  DB_USERNAME: \"coarlumini_user\"\n  DB_PASSWORD: \"${DB_PASSWORD}\"\n  MAIL_PASSWORD: \"\"\n  REDIS_PASSWORD: \"\"\nEOF\n\nlog \"‚úì Secrets creados\"\n\n# ============================================\n# CREAR CONFIGMAP DE COARLUMINI\n# ============================================\n\nlog \"Creando ConfigMap para Coarlumini...\"\ncat \u003c\u003cEOF | kubectl apply -f -\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: coarlumini-config\n  namespace: coarlumini\ndata:\n  APP_PORT: \"80\"\n  DB_HOST: \"coarlumini-database-service\"\n  DB_PORT: \"3306\"\n  DB_DATABASE: \"coarlumini\"\n  FRONTEND_HOST: \"coarlumini-frontend-service\"\n  APP_URL: \"http://coarlumini-backend-service\"\n  APP_ENV: \"production\"\n  APP_DEBUG: \"false\"\n  CACHE_DRIVER: \"file\"\n  SESSION_DRIVER: \"file\"\n  QUEUE_CONNECTION: \"sync\"\n  PROJECT_ID: \"${PROJECT_ID}\"\nEOF\n\nlog \"‚úì ConfigMap creado\"\n\n# ============================================\n# ACTUALIZAR MANIFIESTOS CON RUTAS DE GCR\n# ============================================\n\nlog \"Actualizando manifiestos con rutas de GCR...\"\ncd /root/k8s-manifests\n\n# Actualizar imagen de database\nsed -i \"s|image: mysql:8.0|image: gcr.io/${PROJECT_ID}/coarlumini-database:latest|g\" 04-database-deployment.yaml 2\u003e/dev/null || true\n\n# Actualizar imagen de backend\nsed -i \"s|image: gcr.io/cloudcomputingunsa/coarlumini-backend:latest|image: gcr.io/${PROJECT_ID}/coarlumini-backend:latest|g\" 06-backend-deployment.yaml 2\u003e/dev/null || true\nsed -i \"s|image: gcr.io/[^/]*/coarlumini-backend:latest|image: gcr.io/${PROJECT_ID}/coarlumini-backend:latest|g\" 06-backend-deployment.yaml 2\u003e/dev/null || true\n\n# Actualizar imagen de frontend\nsed -i \"s|image: gcr.io/cloudcomputingunsa/coarlumini-frontend:latest|image: gcr.io/${PROJECT_ID}/coarlumini-frontend:latest|g\" 09-frontend-deployment.yaml 2\u003e/dev/null || true\nsed -i \"s|image: gcr.io/[^/]*/coarlumini-frontend:latest|image: gcr.io/${PROJECT_ID}/coarlumini-frontend:latest|g\" 09-frontend-deployment.yaml 2\u003e/dev/null || true\nsed -i \"s|coarlumini-frontend:late|coarlumini-frontend:latest|g\" 09-frontend-deployment.yaml 2\u003e/dev/null || true\n\n# Cambiar storageClassName a local-path para K3s (ya deber√≠a estar en archivos base, pero por si acaso)\nsed -i \"s|storageClassName: standard-rwo|storageClassName: local-path|g\" 03-database-pvc.yaml 2\u003e/dev/null || true\nsed -i \"s|storageClassName: standard-rwo|storageClassName: local-path|g\" 07-backend-pvc.yaml 2\u003e/dev/null || true\nsed -i \"s|storageClassName: standard-rwo|storageClassName: local-path|g\" 10-frontend-pvc.yaml 2\u003e/dev/null || true\n\n# Configurar imagePullPolicy como IfNotPresent para usar im√°genes locales\nfor file in 04-database-deployment.yaml 06-backend-deployment.yaml 09-frontend-deployment.yaml; do\n    if [ -f \"$file\" ]; then\n        # Remover imagePullPolicy existente\n        sed -i '/imagePullPolicy:/d' \"$file\"\n        # Agregar IfNotPresent despu√©s de cada l√≠nea de image\n        sed -i '/image: gcr.io/a\\          imagePullPolicy: IfNotPresent' \"$file\"\n    fi\ndone\n\nlog \"‚úì Manifiestos actualizados\"\n\n# ============================================\n# DESCARGAR IM√ÅGENES DOCKER DESDE GCR\n# ============================================\n\nlog \"Descargando im√°genes Docker desde GCR...\"\n\n# Autenticar Docker con GCR usando el service account\ngcloud auth configure-docker gcr.io --quiet 2\u003e/dev/null || log \"‚ö† No se pudo configurar docker auth\"\n\n# Descargar las tres im√°genes\nlog \"Descargando imagen de database...\"\ndocker pull gcr.io/${PROJECT_ID}/coarlumini-database:latest 2\u003e/dev/null || log \"‚ö† No se pudo descargar imagen de database\"\n\nlog \"Descargando imagen de backend...\"\ndocker pull gcr.io/${PROJECT_ID}/coarlumini-backend:latest 2\u003e/dev/null || log \"‚ö† No se pudo descargar imagen de backend\"\n\nlog \"Descargando imagen de frontend...\"\ndocker pull gcr.io/${PROJECT_ID}/coarlumini-frontend:latest 2\u003e/dev/null || log \"‚ö† No se pudo descargar imagen de frontend\"\n\n# Verificar im√°genes descargadas\nlog \"Im√°genes Docker locales:\"\ndocker images | grep coarlumini || log \"‚ö† No se encontraron im√°genes de coarlumini\"\n\nlog \"‚úì Im√°genes Docker descargadas\"\n\n# ============================================\n# CREAR SCRIPT DE DEPLOYMENT\n# ============================================\n\nlog \"Creando script de deployment de Coarlumini...\"\ncat \u003e /root/deploy-coarlumini.sh \u003c\u003c'DEPLOY_SCRIPT'\n#!/bin/bash\nset -e\n\nlog() { echo \"[$(date +'%Y-%m-%d %H:%M:%S')] $*\"; }\n\nlog \"=== Desplegando Coarlumini en Kubernetes ===\"\n\ncd /root/k8s-manifests\n\n# Aplicar namespace y configuraciones\nlog \"Aplicando namespace y configuraciones...\"\nkubectl apply -f 00-namespace.yaml 2\u003e/dev/null || true\nkubectl apply -f 01-configmap.yaml 2\u003e/dev/null || true\nkubectl apply -f 02-secrets.yaml 2\u003e/dev/null || true\nkubectl apply -f 11-nginx-config.yaml 2\u003e/dev/null || true\n\n# Aplicar PVCs\nlog \"Creando vol√∫menes persistentes...\"\nkubectl apply -f 03-database-pvc.yaml\nkubectl apply -f 07-backend-pvc.yaml 2\u003e/dev/null || true\nkubectl apply -f 10-frontend-pvc.yaml 2\u003e/dev/null || true\n\n# Desplegar base de datos\nlog \"Desplegando base de datos MySQL...\"\nkubectl apply -f 04-database-deployment.yaml\nkubectl apply -f 05-database-service.yaml\n\nlog \"Esperando a que la base de datos est√© lista (hasta 5 minutos)...\"\nkubectl wait --for=condition=ready pod \\\n    -l app=coarlumini-database \\\n    -n coarlumini \\\n    --timeout=300s || log \"‚ö† Timeout en database, continuando...\"\n\n# Desplegar backend\nlog \"Desplegando backend Laravel...\"\nkubectl apply -f 06-backend-deployment.yaml\nkubectl apply -f 08-backend-service.yaml\n\nlog \"Esperando a que el backend est√© listo (hasta 5 minutos)...\"\nkubectl wait --for=condition=ready pod \\\n    -l app=coarlumini-backend \\\n    -n coarlumini \\\n    --timeout=300s || log \"‚ö† Timeout en backend, continuando...\"\n\n# Desplegar frontend\nlog \"Desplegando frontend Vue.js...\"\nkubectl apply -f 09-frontend-deployment.yaml\nkubectl apply -f 12-frontend-service.yaml\n\nlog \"Esperando a que el frontend est√© listo (hasta 3 minutos)...\"\nkubectl wait --for=condition=ready pod \\\n    -l app=coarlumini-frontend \\\n    -n coarlumini \\\n    --timeout=180s || log \"‚ö† Timeout en frontend, continuando...\"\n\n# Aplicar Ingress\nlog \"Configurando Ingress...\"\nkubectl apply -f 13-ingress.yaml 2\u003e/dev/null || log \"‚ö† No se pudo aplicar Ingress\"\n\n# Aplicar HPA (Horizontal Pod Autoscaler)\nlog \"Configurando Horizontal Pod Autoscaler...\"\nkubectl apply -f 14-horizontal-escalling.yaml 2\u003e/dev/null || log \"‚ö† No se pudo aplicar HPA\"\n\n# Mostrar estado\nlog \"=== Estado del deployment ===\"\nkubectl get all -n coarlumini\n\nlog \"=== Deployment completado ===\"\nDEPLOY_SCRIPT\n\nchmod +x /root/deploy-coarlumini.sh\nlog \"‚úì Script de deployment creado en /root/deploy-coarlumini.sh\"\n\n# ============================================\n# CONFIGURAR HEALTH CHECK CON NGINX\n# ============================================\n\nlog \"Configurando health check endpoint con nginx...\"\napt-get install -y nginx\n\n# Crear p√°gina de estado\ncat \u003e /var/www/html/index.html \u003c\u003cEOF\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"es\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"UTF-8\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e\n    \u003ctitle\u003eK3s Server - Coarlumini\u003c/title\u003e\n    \u003cstyle\u003e\n        body {\n            font-family: 'Arial', sans-serif;\n            margin: 40px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n        }\n        .container {\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 10px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { margin-top: 0; }\n        .info { background: rgba(0, 0, 0, 0.2); padding: 15px; border-radius: 5px; margin: 10px 0; }\n        .status { color: #4ade80; font-weight: bold; }\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"container\"\u003e\n        \u003ch1\u003eüöÄ K3s Master Server - Coarlumini Cluster\u003c/h1\u003e\n        \u003cdiv class=\"info\"\u003e\n            \u003cp\u003e\u003cstrong\u003eStatus:\u003c/strong\u003e \u003cspan class=\"status\"\u003eRunning\u003c/span\u003e\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eNode:\u003c/strong\u003e $(hostname)\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eRole:\u003c/strong\u003e K3s Master (Control Plane)\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eCluster:\u003c/strong\u003e Coarlumini Production\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eApplication:\u003c/strong\u003e Laravel + Vue.js + MySQL\u003c/p\u003e\n        \u003c/div\u003e\n        \u003chr style=\"border-color: rgba(255,255,255,0.2);\"\u003e\n        \u003cp\u003e\u003csmall\u003eEste servidor controla el cluster K3s que ejecuta la aplicaci√≥n Coarlumini\u003c/small\u003e\u003c/p\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e\nEOF\n\nsystemctl enable nginx\nsystemctl start nginx\n\nlog \"‚úì Nginx health check configurado\"\n\n# ============================================\n# CREAR SCRIPT DE INFORMACI√ìN\n# ============================================\n\ncat \u003e /root/info.sh \u003c\u003c'INFO_SCRIPT'\n#!/bin/bash\necho \"==========================================\"\necho \"K3S SERVER - COARLUMINI CLUSTER\"\necho \"==========================================\"\necho \"\"\necho \"üîß Comandos √∫tiles:\"\necho \"\"\necho \"  Ver nodos del cluster:\"\necho \"    kubectl get nodes\"\necho \"\"\necho \"  Ver pods de Coarlumini:\"\necho \"    kubectl get pods -n coarlumini\"\necho \"\"\necho \"  Ver servicios:\"\necho \"    kubectl get svc -n coarlumini\"\necho \"\"\necho \"  Ver logs del backend:\"\necho \"    kubectl logs -l app=coarlumini-backend -n coarlumini -f\"\necho \"\"\necho \"  Ver logs del frontend:\"\necho \"    kubectl logs -l app=coarlumini-frontend -n coarlumini -f\"\necho \"\"\necho \"  Ver logs de la base de datos:\"\necho \"    kubectl logs -l app=coarlumini-database -n coarlumini -f\"\necho \"\"\necho \"  Desplegar/Redesplegar aplicaci√≥n:\"\necho \"    sudo /root/deploy-coarlumini.sh\"\necho \"\"\necho \"  Escalar backend manualmente:\"\necho \"    kubectl scale deployment coarlumini-backend -n coarlumini --replicas=3\"\necho \"\"\necho \"  Reiniciar un componente:\"\necho \"    kubectl rollout restart deployment/coarlumini-backend -n coarlumini\"\necho \"\"\necho \"==========================================\"\nINFO_SCRIPT\n\nchmod +x /root/info.sh\n\n# ============================================\n# MENSAJE DE BIENVENIDA EN SSH\n# ============================================\n\ncat \u003e /etc/motd \u003c\u003c'MOTD'\n\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë                                                              ‚ïë\n‚ïë   üöÄ  K3S MASTER SERVER - COARLUMINI CLUSTER  üöÄ             ‚ïë\n‚ïë                                                              ‚ïë\n‚ïë   Cluster Kubernetes ejecutando aplicaci√≥n Coarlumini       ‚ïë\n‚ïë   (Laravel + Vue.js + MySQL)                                 ‚ïë\n‚ïë                                                              ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n   Ejecuta: /root/info.sh para ver comandos √∫tiles\n\nMOTD\n\n# ============================================\n# FINALIZACI√ìN\n# ============================================\n\nlog \"=== ‚úì Servidor K3s configurado correctamente ===\"\nlog \"=== El servidor est√° listo para recibir nodos worker ===\"\nlog \"=== Token K3s: [REDACTED] ===\"\nlog \"=== Para desplegar Coarlumini, ejecutar: /root/deploy-coarlumini.sh ===\"\n\n# Guardar informaci√≥n de inicializaci√≥n\ncat \u003e /root/init-info.txt \u003c\u003cEOF\nInicializaci√≥n completada: $(date)\nProject ID: ${PROJECT_ID}\nBucket de manifiestos: ${BUCKET_NAME}\nK3s version: $(k3s --version | head -n1)\nKubectl version: $(kubectl version --client --short 2\u003e/dev/null || echo \"N/A\")\nHelm version: $(helm version --short 2\u003e/dev/null || echo \"N/A\")\nEOF\n\nlog \"Informaci√≥n guardada en /root/init-info.txt\"\n\nexit 0\n","min_cpu_platform":"","name":"k3s-master-server","network_interface":[{"access_config":[{"nat_ip":"23.251.151.172","network_tier":"PREMIUM","public_ptr_domain_name":""}],"alias_ip_range":[],"internal_ipv6_prefix_length":0,"ipv6_access_config":[],"ipv6_access_type":"","ipv6_address":"","name":"nic0","network":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/networks/autoscale-network","network_ip":"10.0.1.2","nic_type":"","queue_count":0,"stack_type":"IPV4_ONLY","subnetwork":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/regions/us-central1/subnetworks/autoscale-subnet","subnetwork_project":"cloudcomputingunsa"}],"network_performance_config":[],"params":[],"project":"cloudcomputingunsa","reservation_affinity":[],"resource_policies":null,"scheduling":[{"automatic_restart":true,"instance_termination_action":"","local_ssd_recovery_timeout":[],"max_run_duration":[],"min_node_cpus":0,"node_affinities":[],"on_host_maintenance":"MIGRATE","on_instance_stop_action":[],"preemptible":false,"provisioning_model":"STANDARD"}],"scratch_disk":[],"self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/zones/us-central1-a/instances/k3s-master-server","service_account":[{"email":"k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","scopes":["https://www.googleapis.com/auth/cloud-platform"]}],"shielded_instance_config":[{"enable_integrity_monitoring":true,"enable_secure_boot":false,"enable_vtpm":true}],"tags":["http-server","k3s-server"],"tags_fingerprint":"b2o1clU6kCs=","terraform_labels":{},"timeouts":null,"zone":"us-central1-a"},"sensitive_attributes":[[{"type":"get_attr","value":"boot_disk"},{"type":"index","value":{"value":0,"type":"number"}},{"type":"get_attr","value":"disk_encryption_key_raw"}],[{"type":"get_attr","value":"metadata"},{"type":"index","value":{"value":"db-password","type":"string"}}],[{"type":"get_attr","value":"metadata"},{"type":"index","value":{"value":"k3s-token","type":"string"}}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiNiJ9","dependencies":["google_compute_network.autoscale_network","google_compute_subnetwork.autoscale_subnet","google_service_account.k3s_sa","google_storage_bucket.k8s_manifests","google_storage_bucket_object.k8s_manifests","random_id.app_key","random_id.bucket_suffix","random_password.db_password","random_password.k3s_token"],"create_before_destroy":true}]},{"mode":"managed","type":"google_compute_instance_group_manager","name":"web_group","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"all_instances_config":[],"auto_healing_policies":[{"health_check":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/healthChecks/autohealing-health-check","initial_delay_sec":300}],"base_instance_name":"k3s-agent","creation_timestamp":"2025-11-06T00:04:21.967-08:00","description":"","fingerprint":"Cszsh4_rECY=","id":"projects/cloudcomputingunsa/zones/us-central1-a/instanceGroupManagers/web-group-manager","instance_group":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/zones/us-central1-a/instanceGroups/web-group-manager","instance_lifecycle_policy":[{"default_action_on_failure":"REPAIR","force_update_on_repair":"NO"}],"list_managed_instances_results":"PAGELESS","name":"web-group-manager","named_port":[{"name":"http","port":80}],"operation":null,"project":"cloudcomputingunsa","self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/zones/us-central1-a/instanceGroupManagers/web-group-manager","stateful_disk":[],"stateful_external_ip":[],"stateful_internal_ip":[],"status":[{"all_instances_config":[{"current_revision":"","effective":true}],"is_stable":false,"stateful":[{"has_stateful_config":false,"per_instance_configs":[{"all_effective":true}]}],"version_target":[{"is_reached":true}]}],"target_pools":null,"target_size":2,"timeouts":null,"update_policy":[{"max_surge_fixed":1,"max_surge_percent":0,"max_unavailable_fixed":1,"max_unavailable_percent":0,"minimal_action":"REPLACE","most_disruptive_allowed_action":"","replacement_method":"SUBSTITUTE","type":"OPPORTUNISTIC"}],"version":[{"instance_template":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/instanceTemplates/k3s-agent-template-20251106080417812800000001","name":"primary","target_size":[]}],"wait_for_instances":false,"wait_for_instances_status":"STABLE","zone":"us-central1-a"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo5MDAwMDAwMDAwMDAsImRlbGV0ZSI6OTAwMDAwMDAwMDAwLCJ1cGRhdGUiOjkwMDAwMDAwMDAwMH19","dependencies":["google_compute_health_check.autohealing","google_compute_instance.k3s_server","google_compute_instance_template.web_template","google_compute_network.autoscale_network","google_compute_subnetwork.autoscale_subnet","google_service_account.k3s_sa","google_storage_bucket.k8s_manifests","google_storage_bucket_object.k8s_manifests","random_id.app_key","random_id.bucket_suffix","random_password.db_password","random_password.k3s_token"]}]},{"mode":"managed","type":"google_compute_instance_template","name":"web_template","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":1,"attributes":{"advanced_machine_features":[],"can_ip_forward":false,"confidential_instance_config":null,"description":"","disk":[{"auto_delete":true,"boot":true,"device_name":"persistent-disk-0","disk_encryption_key":[],"disk_name":"","disk_size_gb":30,"disk_type":"pd-standard","interface":"SCSI","labels":null,"mode":"READ_WRITE","provisioned_iops":0,"resource_manager_tags":null,"resource_policies":null,"source":"","source_image":"projects/ubuntu-os-cloud/global/images/family/ubuntu-2204-lts","source_image_encryption_key":[],"source_snapshot":"","source_snapshot_encryption_key":[],"type":"PERSISTENT"}],"effective_labels":{},"guest_accelerator":[],"id":"projects/cloudcomputingunsa/global/instanceTemplates/k3s-agent-template-20251106080417812800000001","instance_description":"","labels":null,"machine_type":"e2-small","metadata":{"enable-oslogin":"TRUE"},"metadata_fingerprint":"dl-zW_PkVvY=","metadata_startup_script":"#!/bin/bash\nset -e\n\n# ============================================\n# K3S AGENT INITIALIZATION SCRIPT\n# ============================================\n# Este script se ejecuta autom√°ticamente cuando\n# se crea una instancia del grupo de autoscaling\n# convirtiendo cada instancia en un worker K3s\n# ============================================\n\nlog() { echo \"[$(date +'%Y-%m-%d %H:%M:%S')] $*\"; }\nerror() { echo \"[$(date +'%Y-%m-%d %H:%M:%S')] ERROR: $*\" \u003e\u00262; }\n\nlog \"=== Iniciando configuraci√≥n del agente K3s ===\"\n\n# ============================================\n# OBTENER METADATA (Pasados como template variables)\n# ============================================\n\nK3S_TOKEN=\"lxp5Mrvr473HEeEVFePEIfYCDXvkQ1gaIQbhWL8zlfDo6qBzraH2l2d06sSgOiQ4\"\nSERVER_IP=\"10.0.1.2\"\nPROJECT_ID=\"cloudcomputingunsa\"\n\nlog \"Configuraci√≥n recibida:\"\nlog \"  - Servidor K3s: $SERVER_IP\"\nlog \"  - Proyecto GCP: $PROJECT_ID\"\n\n# ============================================\n# ACTUALIZAR SISTEMA\n# ============================================\n\nlog \"Actualizando sistema operativo...\"\nexport DEBIAN_FRONTEND=noninteractive\napt-get update -y\napt-get upgrade -y -o Dpkg::Options::=\"--force-confold\"\n\n# ============================================\n# INSTALAR PAQUETES NECESARIOS\n# ============================================\n\nlog \"Instalando paquetes necesarios...\"\napt-get install -y \\\n    curl \\\n    wget \\\n    nfs-common \\\n    ca-certificates \\\n    gnupg \\\n    lsb-release \\\n    apt-transport-https\n\n# ============================================\n# INSTALAR GCLOUD CLI\n# ============================================\n\nlog \"Instalando Google Cloud SDK...\"\necho \"deb [signed-by=/usr/share/keyrings/cloud.google.gpg] https://packages.cloud.google.com/apt cloud-sdk main\" | \\\n    tee -a /etc/apt/sources.list.d/google-cloud-sdk.list\n\ncurl https://packages.cloud.google.com/apt/doc/apt-key.gpg | \\\n    apt-key --keyring /usr/share/keyrings/cloud.google.gpg add -\n\napt-get update -y\napt-get install -y google-cloud-cli\n\nlog \"‚úì Google Cloud SDK instalado\"\n\n# ============================================\n# INSTALAR DOCKER\n# ============================================\n\nlog \"Instalando Docker...\"\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsh get-docker.sh\nrm get-docker.sh\n\nsystemctl enable docker\nsystemctl start docker\n\ndocker --version || error \"Docker no se instal√≥ correctamente\"\n\nlog \"‚úì Docker instalado correctamente\"\n\n# ============================================\n# CONFIGURAR DOCKER PARA GCR\n# ============================================\n\nlog \"Configurando Docker para Google Container Registry...\"\n\n# Configurar Docker credential helper para GCR\ngcloud auth configure-docker gcr.io --quiet\n\n# Crear configuraci√≥n adicional de Docker\nmkdir -p /etc/docker\ncat \u003e /etc/docker/daemon.json \u003c\u003cEOF\n{\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"10m\",\n    \"max-file\": \"3\"\n  },\n  \"storage-driver\": \"overlay2\"\n}\nEOF\n\n# Reiniciar Docker para aplicar cambios\nsystemctl restart docker\n\nlog \"‚úì Docker configurado para GCR\"\n\n# ============================================\n# ESPERAR A QUE EL SERVIDOR K3S EST√â DISPONIBLE\n# ============================================\n\nlog \"Verificando disponibilidad del servidor K3s en $SERVER_IP:6443...\"\ntimeout=300\nelapsed=0\n\nuntil curl -k -s https://$SERVER_IP:6443 \u003e/dev/null 2\u003e\u00261; do\n    if [ $elapsed -ge $timeout ]; then\n        error \"Servidor K3s no disponible despu√©s de $timeout segundos\"\n        error \"No se puede unir este nodo al cluster\"\n        exit 1\n    fi\n    log \"Servidor K3s no responde a√∫n, esperando... ($elapsed/$timeout segundos)\"\n    sleep 10\n    elapsed=$((elapsed + 10))\ndone\n\nlog \"‚úì Servidor K3s accesible en $SERVER_IP:6443\"\n\n# ============================================\n# INSTALAR K3S AGENT\n# ============================================\n\nlog \"Instalando K3s agent y uni√©ndose al cluster...\"\ncurl -sfL https://get.k3s.io | K3S_URL=\"https://$SERVER_IP:6443\" \\\n    K3S_TOKEN=\"$K3S_TOKEN\" \\\n    INSTALL_K3S_EXEC=\"--node-label=role=worker\" \\\n    sh -\n\n# ============================================\n# ESPERAR A QUE EL AGENTE EST√â LISTO\n# ============================================\n\nlog \"Esperando a que el agente K3s est√© listo...\"\nsleep 30\n\n# Verificar que el servicio est√© corriendo\nif systemctl is-active --quiet k3s-agent; then\n    log \"‚úì Servicio k3s-agent est√° corriendo\"\nelse\n    error \"El servicio k3s-agent no est√° corriendo\"\n    systemctl status k3s-agent --no-pager\n    journalctl -u k3s-agent -n 50 --no-pager\n    exit 1\nfi\n\n# ============================================\n# DESCARGAR IM√ÅGENES DOCKER DESDE GCR\n# ============================================\n\nlog \"Descargando im√°genes Docker desde GCR...\"\n\n# Esperar un momento para asegurar que Docker est√© completamente listo\nsleep 5\n\n# Descargar im√°genes una por una (sin usar array para\n evitar problemas con templatefile)\nlog \"Descargando imagen de database...\"\nif docker pull \"gcr.io/cloudcomputingunsa/coarlumini-database:latest\" 2\u003e\u00261 | tee /tmp/docker-pull-db.log; then\n    log \"‚úì Imagen database descargada\"\nelse\n    log \"‚ö† No se pudo descargar imagen database, se descargar√° cuando sea necesario\"\nfi\n\nlog \"Descargando imagen de backend...\"\nif docker pull \"gcr.io/cloudcomputingunsa/coarlumini-backend:latest\" 2\u003e\u00261 | tee /tmp/docker-pull-backend.log; then\n    log \"‚úì Imagen backend descargada\"\nelse\n    log \"‚ö† No se pudo descargar imagen backend, se descargar√° cuando sea necesario\"\nfi\n\nlog \"Descargando imagen de frontend...\"\nif docker pull \"gcr.io/cloudcomputingunsa/coarlumini-frontend:latest\" 2\u003e\u00261 | tee /tmp/docker-pull-frontend.log; then\n    log \"‚úì Imagen frontend descargada\"\nelse\n    log \"‚ö† No se pudo descargar imagen frontend, se descargar√° cuando sea necesario\"\nfi\n\n# Verificar im√°genes descargadas\nlog \"Im√°genes Docker locales:\"\ndocker images | grep coarlumini || log \"‚ö† No se encontraron im√°genes de coarlumini localmente\"\n\nlog \"‚úì Proceso de descarga de im√°genes completado\"\n\n# ============================================\n# CONFIGURAR HEALTH CHECK CON NGINX\n# ============================================\n\nlog \"Configurando endpoint de health check con nginx...\"\napt-get install -y nginx\n\n# Obtener informaci√≥n de la instancia\nINSTANCE_NAME=$(hostname)\nZONE=$(curl -s -H \"Metadata-Flavor: Google\" http://metadata.google.internal/computeMetadata/v1/instance/zone | awk -F/ '{print $4}')\nINTERNAL_IP=$(hostname -I | awk '{print $1}')\n\n# Crear p√°gina de estado\ncat \u003e /var/www/html/index.html \u003c\u003cEOF\n\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"es\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"UTF-8\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e\n    \u003ctitle\u003eK3s Agent - Coarlumini\u003c/title\u003e\n    \u003cstyle\u003e\n        body {\n            font-family: 'Arial', sans-serif;\n            margin: 40px;\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n        }\n        .container {\n            background: rgba(255, 255, 255, 0.1);\n            padding: 30px;\n            border-radius: 10px;\n            backdrop-filter: blur(10px);\n        }\n        h1 { margin-top: 0; }\n        .info { background: rgba(0, 0, 0, 0.2); padding: 15px; border-radius: 5px; margin: 10px 0; }\n        .status { color: #4ade80; font-weight: bold; }\n        .detail { color: #60a5fa; }\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cdiv class=\"container\"\u003e\n        \u003ch1\u003e‚ö° K3s Worker Node - Coarlumini Cluster\u003c/h1\u003e\n        \u003cdiv class=\"info\"\u003e\n            \u003cp\u003e\u003cstrong\u003eStatus:\u003c/strong\u003e \u003cspan class=\"status\"\u003eRunning\u003c/span\u003e\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eNode:\u003c/strong\u003e \u003cspan class=\"detail\"\u003e$INSTANCE_NAME\u003c/span\u003e\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eRole:\u003c/strong\u003e K3s Worker (Agent)\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eZone:\u003c/strong\u003e \u003cspan class=\"detail\"\u003e$ZONE\u003c/span\u003e\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eInternal IP:\u003c/strong\u003e \u003cspan class=\"detail\"\u003e$INTERNAL_IP\u003c/span\u003e\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eConnected to:\u003c/strong\u003e \u003cspan class=\"detail\"\u003e$SERVER_IP\u003c/span\u003e\u003c/p\u003e\n            \u003cp\u003e\u003cstrong\u003eCluster:\u003c/strong\u003e Coarlumini Production\u003c/p\u003e\n        \u003c/div\u003e\n        \u003chr style=\"border-color: rgba(255,255,255,0.2);\"\u003e\n        \u003cp\u003e\u003csmall\u003eEste nodo ejecuta workloads de la aplicaci√≥n Coarlumini\u003c/small\u003e\u003c/p\u003e\n    \u003c/div\u003e\n\u003c/body\u003e\n\u003c/html\u003e\nEOF\n\nsystemctl enable nginx\nsystemctl start nginx\n\nlog \"‚úì Nginx health check configurado en puerto 80\"\n\n# ============================================\n# OPTIMIZACIONES PARA K3S\n# ============================================\n\nlog \"Aplicando optimizaciones para K3s...\"\n\n# Aumentar l√≠mites de archivos\ncat \u003e\u003e /etc/sysctl.conf \u003c\u003cEOF\n\n# K3s optimizations\nfs.inotify.max_user_watches = 524288\nfs.inotify.max_user_instances = 512\nnet.ipv4.ip_forward = 1\nEOF\n\nsysctl -p\n\n# ============================================\n# CREAR SCRIPT DE INFORMACI√ìN\n# ============================================\n\ncat \u003e /usr/local/bin/node-info \u003c\u003c'INFO_SCRIPT'\n#!/bin/bash\necho \"==========================================\"\necho \"K3S WORKER NODE - COARLUMINI CLUSTER\"\necho \"==========================================\"\necho \"\"\necho \"Node: $(hostname)\"\necho \"Internal IP: $(hostname -I | awk '{print $1}')\"\necho \"Status: $(systemctl is-active k3s-agent)\"\necho \"\"\necho \"K3s Agent Version:\"\nk3s --version | head -n1\necho \"\"\necho \"Docker Version:\"\ndocker --version\necho \"\"\necho \"Im√°genes Docker locales:\"\ndocker images | grep coarlumini || echo \"No hay im√°genes de coarlumini\"\necho \"\"\necho \"==========================================\"\necho \"\"\necho \"üí° Este nodo es un worker del cluster K3s\"\necho \"   Los pods de Coarlumini pueden ejecutarse aqu√≠\"\necho \"\"\necho \"Para ver logs del agente:\"\necho \"  journalctl -u k3s-agent -f\"\necho \"\"\necho \"==========================================\"\nINFO_SCRIPT\n\nchmod +x /usr/local/bin/node-info\n\n# ============================================\n# MENSAJE DE BIENVENIDA\n# ============================================\n\ncat \u003e /etc/motd \u003c\u003c'MOTD'\n\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë                                                              ‚ïë\n‚ïë   ‚ö°  K3S WORKER NODE - COARLUMINI CLUSTER  ‚ö°               ‚ïë\n‚ïë                                                              ‚ïë\n‚ïë   Este nodo ejecuta workloads del cluster Kubernetes        ‚ïë\n‚ïë                                                              ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n   Ejecuta: node-info para ver informaci√≥n del nodo\n\nMOTD\n\n# ============================================\n# FINALIZACI√ìN\n# ============================================\n\nlog \"=== ‚úì Agente K3s configurado correctamente ===\"\nlog \"=== Nodo unido al cluster exitosamente ===\"\nlog \"=== Servidor maestro: $SERVER_IP ===\"\nlog \"=== Este nodo est√° listo para ejecutar pods ===\"\n\n# Guardar informaci√≥n de inicializaci√≥n\ncat \u003e /root/init-info.txt \u003c\u003cEOF\nInicializaci√≥n completada: $(date)\nServidor K3s: $SERVER_IP\nProject ID: $PROJECT_ID\nNode name: $(hostname)\nInternal IP: $(hostname -I | awk '{print $1}')\nZone: $ZONE\nK3s version: $(k3s --version | head -n1)\nDocker version: $(docker --version)\nStatus: $(systemctl is-active k3s-agent)\nEOF\n\nlog \"Informaci√≥n guardada en /root/init-info.txt\"\n\nexit 0\n","min_cpu_platform":"","name":"k3s-agent-template-20251106080417812800000001","name_prefix":"k3s-agent-template-","network_interface":[{"access_config":[{"nat_ip":"","network_tier":"PREMIUM","public_ptr_domain_name":""}],"alias_ip_range":[],"internal_ipv6_prefix_length":0,"ipv6_access_config":[],"ipv6_access_type":"","ipv6_address":"","name":"nic0","network":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/networks/autoscale-network","network_ip":"","nic_type":"","queue_count":0,"stack_type":"","subnetwork":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/regions/us-central1/subnetworks/autoscale-subnet","subnetwork_project":"cloudcomputingunsa"}],"network_performance_config":[],"project":"cloudcomputingunsa","region":"us-central1","reservation_affinity":[],"resource_manager_tags":null,"resource_policies":null,"scheduling":[{"automatic_restart":true,"instance_termination_action":"","local_ssd_recovery_timeout":[],"max_run_duration":[],"min_node_cpus":0,"node_affinities":[],"on_host_maintenance":"MIGRATE","on_instance_stop_action":[],"preemptible":false,"provisioning_model":"STANDARD"}],"self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/instanceTemplates/k3s-agent-template-20251106080417812800000001","self_link_unique":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/instanceTemplates/k3s-agent-template-20251106080417812800000001?uniqueId=6460833707755432045","service_account":[{"email":"k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","scopes":["https://www.googleapis.com/auth/cloud-platform"]}],"shielded_instance_config":[],"tags":["http-server","k3s-agent"],"tags_fingerprint":"","terraform_labels":{},"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"metadata_startup_script"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=","dependencies":["google_compute_instance.k3s_server","google_compute_network.autoscale_network","google_compute_subnetwork.autoscale_subnet","google_service_account.k3s_sa","google_storage_bucket.k8s_manifests","google_storage_bucket_object.k8s_manifests","random_id.app_key","random_id.bucket_suffix","random_password.db_password","random_password.k3s_token"],"create_before_destroy":true}]},{"mode":"managed","type":"google_compute_network","name":"autoscale_network","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"auto_create_subnetworks":false,"delete_default_routes_on_create":false,"description":"","enable_ula_internal_ipv6":false,"gateway_ipv4":"","id":"projects/cloudcomputingunsa/global/networks/autoscale-network","internal_ipv6_range":"","mtu":0,"name":"autoscale-network","network_firewall_policy_enforcement_order":"AFTER_CLASSIC_FIREWALL","numeric_id":"4507757085779421406","project":"cloudcomputingunsa","routing_mode":"REGIONAL","self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/networks/autoscale-network","timeouts":null},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19","create_before_destroy":true}]},{"mode":"managed","type":"google_compute_subnetwork","name":"autoscale_subnet","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"creation_timestamp":"2025-11-06T00:03:20.615-08:00","description":"","external_ipv6_prefix":"","fingerprint":null,"gateway_address":"10.0.1.1","id":"projects/cloudcomputingunsa/regions/us-central1/subnetworks/autoscale-subnet","internal_ipv6_prefix":"","ip_cidr_range":"10.0.1.0/24","ipv6_access_type":"","ipv6_cidr_range":"","log_config":[],"name":"autoscale-subnet","network":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/networks/autoscale-network","private_ip_google_access":false,"private_ipv6_google_access":"DISABLE_GOOGLE_ACCESS","project":"cloudcomputingunsa","purpose":"PRIVATE","region":"us-central1","role":"","secondary_ip_range":[],"self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/regions/us-central1/subnetworks/autoscale-subnet","send_secondary_ip_range_if_empty":null,"stack_type":"IPV4_ONLY","timeouts":null},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19","dependencies":["google_compute_network.autoscale_network"],"create_before_destroy":true}]},{"mode":"managed","type":"google_compute_target_http_proxy","name":"web_proxy","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"creation_timestamp":"2025-11-06T00:06:48.403-08:00","description":"","http_keep_alive_timeout_sec":0,"id":"projects/cloudcomputingunsa/global/targetHttpProxies/web-proxy","name":"web-proxy","project":"cloudcomputingunsa","proxy_bind":false,"proxy_id":3468245489703578103,"self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/targetHttpProxies/web-proxy","timeouts":null,"url_map":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/urlMaps/web-url-map"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19","dependencies":["google_compute_backend_service.web_backend","google_compute_health_check.autohealing","google_compute_instance.k3s_server","google_compute_instance_group_manager.web_group","google_compute_instance_template.web_template","google_compute_network.autoscale_network","google_compute_subnetwork.autoscale_subnet","google_compute_url_map.web_url_map","google_service_account.k3s_sa","google_storage_bucket.k8s_manifests","google_storage_bucket_object.k8s_manifests","random_id.app_key","random_id.bucket_suffix","random_password.db_password","random_password.k3s_token"]}]},{"mode":"managed","type":"google_compute_url_map","name":"web_url_map","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"creation_timestamp":"2025-11-06T00:06:36.454-08:00","default_route_action":[],"default_service":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/backendServices/web-backend-service","default_url_redirect":[],"description":"","fingerprint":"PRzBacZwGes=","header_action":[],"host_rule":[],"id":"projects/cloudcomputingunsa/global/urlMaps/web-url-map","map_id":8856335911619783139,"name":"web-url-map","path_matcher":[],"project":"cloudcomputingunsa","self_link":"https://www.googleapis.com/compute/v1/projects/cloudcomputingunsa/global/urlMaps/web-url-map","test":[],"timeouts":null},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19","dependencies":["google_compute_backend_service.web_backend","google_compute_health_check.autohealing","google_compute_instance.k3s_server","google_compute_instance_group_manager.web_group","google_compute_instance_template.web_template","google_compute_network.autoscale_network","google_compute_subnetwork.autoscale_subnet","google_service_account.k3s_sa","google_storage_bucket.k8s_manifests","google_storage_bucket_object.k8s_manifests","random_id.app_key","random_id.bucket_suffix","random_password.db_password","random_password.k3s_token"]}]},{"mode":"managed","type":"google_project_iam_member","name":"k3s_sa_artifact_registry","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"condition":[],"etag":"BwZC6H9OBZ0=","id":"cloudcomputingunsa/roles/artifactregistry.reader/serviceAccount:k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","member":"serviceAccount:k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","project":"cloudcomputingunsa","role":"roles/artifactregistry.reader"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["google_service_account.k3s_sa"]}]},{"mode":"managed","type":"google_project_iam_member","name":"k3s_sa_gcr","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"condition":[],"etag":"BwZC6H9OBZ0=","id":"cloudcomputingunsa/roles/storage.objectViewer/serviceAccount:k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","member":"serviceAccount:k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","project":"cloudcomputingunsa","role":"roles/storage.objectViewer"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["google_service_account.k3s_sa"]}]},{"mode":"managed","type":"google_project_iam_member","name":"k3s_sa_storage","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"condition":[],"etag":"BwZC6H9OBZ0=","id":"cloudcomputingunsa/roles/storage.objectViewer/serviceAccount:k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","member":"serviceAccount:k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","project":"cloudcomputingunsa","role":"roles/storage.objectViewer"},"sensitive_attributes":[],"private":"bnVsbA==","dependencies":["google_service_account.k3s_sa"]}]},{"mode":"managed","type":"google_service_account","name":"k3s_sa","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":0,"attributes":{"account_id":"k3s-cluster-sa","create_ignore_already_exists":null,"description":"","disabled":false,"display_name":"K3s Cluster Service Account","email":"k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","id":"projects/cloudcomputingunsa/serviceAccounts/k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","member":"serviceAccount:k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","name":"projects/cloudcomputingunsa/serviceAccounts/k3s-cluster-sa@cloudcomputingunsa.iam.gserviceaccount.com","project":"cloudcomputingunsa","timeouts":null,"unique_id":"109083436146999639005"},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDB9fQ==","create_before_destroy":true}]},{"mode":"managed","type":"google_storage_bucket","name":"k8s_manifests","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"schema_version":2,"attributes":{"autoclass":[],"cors":[],"custom_placement_config":[],"default_event_based_hold":false,"effective_labels":{},"enable_object_retention":false,"encryption":[],"force_destroy":true,"id":"cloudcomputingunsa-k8s-9175ad57","labels":null,"lifecycle_rule":[],"location":"US-CENTRAL1","logging":[],"name":"cloudcomputingunsa-k8s-9175ad57","project":"cloudcomputingunsa","project_number":677157926047,"public_access_prevention":"inherited","requester_pays":false,"retention_policy":[],"rpo":null,"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57","soft_delete_policy":[{"effective_time":"2025-11-06T08:02:57.761Z","retention_duration_seconds":604800}],"storage_class":"STANDARD","terraform_labels":{},"timeouts":null,"uniform_bucket_level_access":true,"url":"gs://cloudcomputingunsa-k8s-9175ad57","versioning":[],"website":[]},"sensitive_attributes":[],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsInJlYWQiOjI0MDAwMDAwMDAwMCwidXBkYXRlIjoyNDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjIifQ==","dependencies":["random_id.bucket_suffix"],"create_before_destroy":true}]},{"mode":"managed","type":"google_storage_bucket_object","name":"k8s_manifests","provider":"provider[\"registry.opentofu.org/hashicorp/google\"]","instances":[{"index_key":"00-namespace.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"3QXMYw==","customer_encryption":[],"detect_md5hash":"6acG6O8oeolUfHhbg1BVjA==","event_based_hold":false,"generation":1762416180315121,"id":"cloudcomputingunsa-k8s-9175ad57-00-namespace.yaml","kms_key_name":"","md5hash":"6acG6O8oeolUfHhbg1BVjA==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/00-namespace.yaml?generation=1762416180315121\u0026alt=media","metadata":null,"name":"00-namespace.yaml","output_name":"00-namespace.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/00-namespace.yaml","source":"./../coarlumini/k8s/00-namespace.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"01-configmap.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"yTR3rw==","customer_encryption":[],"detect_md5hash":"KzUw/hINyG+GBgHssWSXEQ==","event_based_hold":false,"generation":1762416182014730,"id":"cloudcomputingunsa-k8s-9175ad57-01-configmap.yaml","kms_key_name":"","md5hash":"KzUw/hINyG+GBgHssWSXEQ==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/01-configmap.yaml?generation=1762416182014730\u0026alt=media","metadata":null,"name":"01-configmap.yaml","output_name":"01-configmap.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/01-configmap.yaml","source":"./../coarlumini/k8s/01-configmap.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"02-secrets.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"VxVyoA==","customer_encryption":[],"detect_md5hash":"sQxDxS/DtmnMZP3Tb+BJAg==","event_based_hold":false,"generation":1762416179915184,"id":"cloudcomputingunsa-k8s-9175ad57-02-secrets.yaml","kms_key_name":"","md5hash":"sQxDxS/DtmnMZP3Tb+BJAg==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/02-secrets.yaml?generation=1762416179915184\u0026alt=media","metadata":null,"name":"02-secrets.yaml","output_name":"02-secrets.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/02-secrets.yaml","source":"./../coarlumini/k8s/02-secrets.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"03-database-pvc.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"fcqN4g==","customer_encryption":[],"detect_md5hash":"aRa561SgIXvk/L+PoGlY2A==","event_based_hold":false,"generation":1762416180311748,"id":"cloudcomputingunsa-k8s-9175ad57-03-database-pvc.yaml","kms_key_name":"","md5hash":"aRa561SgIXvk/L+PoGlY2A==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/03-database-pvc.yaml?generation=1762416180311748\u0026alt=media","metadata":null,"name":"03-database-pvc.yaml","output_name":"03-database-pvc.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/03-database-pvc.yaml","source":"./../coarlumini/k8s/03-database-pvc.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"04-database-deployment.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"u1pM1Q==","customer_encryption":[],"detect_md5hash":"Jwmw8IMRw2Hyt6kJsykFSQ==","event_based_hold":false,"generation":1762416183412922,"id":"cloudcomputingunsa-k8s-9175ad57-04-database-deployment.yaml","kms_key_name":"","md5hash":"Jwmw8IMRw2Hyt6kJsykFSQ==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/04-database-deployment.yaml?generation=1762416183412922\u0026alt=media","metadata":null,"name":"04-database-deployment.yaml","output_name":"04-database-deployment.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/04-database-deployment.yaml","source":"./../coarlumini/k8s/04-database-deployment.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"05-database-service.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"4zqthw==","customer_encryption":[],"detect_md5hash":"2tL2GvgzuK7ZhgY9p/eZUA==","event_based_hold":false,"generation":1762416183212843,"id":"cloudcomputingunsa-k8s-9175ad57-05-database-service.yaml","kms_key_name":"","md5hash":"2tL2GvgzuK7ZhgY9p/eZUA==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/05-database-service.yaml?generation=1762416183212843\u0026alt=media","metadata":null,"name":"05-database-service.yaml","output_name":"05-database-service.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/05-database-service.yaml","source":"./../coarlumini/k8s/05-database-service.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"06-backend-deployment.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"Br/sBA==","customer_encryption":[],"detect_md5hash":"uwe1wA8yBmqndRkJtzaw0g==","event_based_hold":false,"generation":1762416183213143,"id":"cloudcomputingunsa-k8s-9175ad57-06-backend-deployment.yaml","kms_key_name":"","md5hash":"uwe1wA8yBmqndRkJtzaw0g==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/06-backend-deployment.yaml?generation=1762416183213143\u0026alt=media","metadata":null,"name":"06-backend-deployment.yaml","output_name":"06-backend-deployment.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/06-backend-deployment.yaml","source":"./../coarlumini/k8s/06-backend-deployment.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"07-backend-pvc.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"L7Pg9Q==","customer_encryption":[],"detect_md5hash":"jVy5h3JyGOzhVzL/rT2mBg==","event_based_hold":false,"generation":1762416180413807,"id":"cloudcomputingunsa-k8s-9175ad57-07-backend-pvc.yaml","kms_key_name":"","md5hash":"jVy5h3JyGOzhVzL/rT2mBg==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/07-backend-pvc.yaml?generation=1762416180413807\u0026alt=media","metadata":null,"name":"07-backend-pvc.yaml","output_name":"07-backend-pvc.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/07-backend-pvc.yaml","source":"./../coarlumini/k8s/07-backend-pvc.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"08-backend-service.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"Tck41A==","customer_encryption":[],"detect_md5hash":"PNyabxoXXl7uyRssdqaIwg==","event_based_hold":false,"generation":1762416183110967,"id":"cloudcomputingunsa-k8s-9175ad57-08-backend-service.yaml","kms_key_name":"","md5hash":"PNyabxoXXl7uyRssdqaIwg==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/08-backend-service.yaml?generation=1762416183110967\u0026alt=media","metadata":null,"name":"08-backend-service.yaml","output_name":"08-backend-service.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/08-backend-service.yaml","source":"./../coarlumini/k8s/08-backend-service.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"09-frontend-deployment.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"uX6FXQ==","customer_encryption":[],"detect_md5hash":"JfUH1YGnRxc/dbiJYMLeww==","event_based_hold":false,"generation":1762416180312365,"id":"cloudcomputingunsa-k8s-9175ad57-09-frontend-deployment.yaml","kms_key_name":"","md5hash":"JfUH1YGnRxc/dbiJYMLeww==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/09-frontend-deployment.yaml?generation=1762416180312365\u0026alt=media","metadata":null,"name":"09-frontend-deployment.yaml","output_name":"09-frontend-deployment.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/09-frontend-deployment.yaml","source":"./../coarlumini/k8s/09-frontend-deployment.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"10-frontend-pvc.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"22W22g==","customer_encryption":[],"detect_md5hash":"4QRLFdwgTYlmSBq/qvpR5g==","event_based_hold":false,"generation":1762416180321915,"id":"cloudcomputingunsa-k8s-9175ad57-10-frontend-pvc.yaml","kms_key_name":"","md5hash":"4QRLFdwgTYlmSBq/qvpR5g==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/10-frontend-pvc.yaml?generation=1762416180321915\u0026alt=media","metadata":null,"name":"10-frontend-pvc.yaml","output_name":"10-frontend-pvc.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/10-frontend-pvc.yaml","source":"./../coarlumini/k8s/10-frontend-pvc.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"11-nginx-config.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"4ewpvA==","customer_encryption":[],"detect_md5hash":"xXaEVRU7wvn/ujHikVLxJg==","event_based_hold":false,"generation":1762416181912841,"id":"cloudcomputingunsa-k8s-9175ad57-11-nginx-config.yaml","kms_key_name":"","md5hash":"xXaEVRU7wvn/ujHikVLxJg==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/11-nginx-config.yaml?generation=1762416181912841\u0026alt=media","metadata":null,"name":"11-nginx-config.yaml","output_name":"11-nginx-config.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/11-nginx-config.yaml","source":"./../coarlumini/k8s/11-nginx-config.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"12-frontend-service.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"sp1UJg==","customer_encryption":[],"detect_md5hash":"PXeivAUVdQwVqrdbsWE5OQ==","event_based_hold":false,"generation":1762416180313210,"id":"cloudcomputingunsa-k8s-9175ad57-12-frontend-service.yaml","kms_key_name":"","md5hash":"PXeivAUVdQwVqrdbsWE5OQ==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/12-frontend-service.yaml?generation=1762416180313210\u0026alt=media","metadata":null,"name":"12-frontend-service.yaml","output_name":"12-frontend-service.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/12-frontend-service.yaml","source":"./../coarlumini/k8s/12-frontend-service.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"13-ingress.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"/c4JPA==","customer_encryption":[],"detect_md5hash":"+WlUChbZabafqN9i8Em8RQ==","event_based_hold":false,"generation":1762416183213429,"id":"cloudcomputingunsa-k8s-9175ad57-13-ingress.yaml","kms_key_name":"","md5hash":"+WlUChbZabafqN9i8Em8RQ==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/13-ingress.yaml?generation=1762416183213429\u0026alt=media","metadata":null,"name":"13-ingress.yaml","output_name":"13-ingress.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/13-ingress.yaml","source":"./../coarlumini/k8s/13-ingress.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true},{"index_key":"14-horizontal-escalling.yaml","schema_version":0,"attributes":{"bucket":"cloudcomputingunsa-k8s-9175ad57","cache_control":"","content":null,"content_disposition":"","content_encoding":"","content_language":"","content_type":"text/plain; charset=utf-8","crc32c":"LBBBqg==","customer_encryption":[],"detect_md5hash":"AanneJpGQV+MES+2kIwhRg==","event_based_hold":false,"generation":1762416183212885,"id":"cloudcomputingunsa-k8s-9175ad57-14-horizontal-escalling.yaml","kms_key_name":"","md5hash":"AanneJpGQV+MES+2kIwhRg==","media_link":"https://storage.googleapis.com/download/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/14-horizontal-escalling.yaml?generation=1762416183212885\u0026alt=media","metadata":null,"name":"14-horizontal-escalling.yaml","output_name":"14-horizontal-escalling.yaml","retention":[],"self_link":"https://www.googleapis.com/storage/v1/b/cloudcomputingunsa-k8s-9175ad57/o/14-horizontal-escalling.yaml","source":"./../coarlumini/k8s/14-horizontal-escalling.yaml","storage_class":"STANDARD","temporary_hold":false,"timeouts":null},"sensitive_attributes":[[{"type":"get_attr","value":"content"}]],"private":"eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoyNDAwMDAwMDAwMDAsImRlbGV0ZSI6MjQwMDAwMDAwMDAwLCJ1cGRhdGUiOjI0MDAwMDAwMDAwMH19","dependencies":["google_storage_bucket.k8s_manifests","random_id.bucket_suffix"],"create_before_destroy":true}]},{"mode":"managed","type":"null_resource","name":"deploy_coarlumini","provider":"provider[\"registry.opentofu.org/hashicorp/null\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"id":"4682943713214597167","triggers":{"instance_group":"projects/cloudcomputingunsa/zones/us-central1-a/instanceGroupManagers/web-group-manager","manifests_bucket":"cloudcomputingunsa-k8s-9175ad57","server_id":"projects/cloudcomputingunsa/zones/us-central1-a/instances/k3s-master-server"}},"sensitive_attributes":[],"dependencies":["google_compute_health_check.autohealing","google_compute_instance.k3s_server","google_compute_instance_group_manager.web_group","google_compute_instance_template.web_template","google_compute_network.autoscale_network","google_compute_subnetwork.autoscale_subnet","google_service_account.k3s_sa","google_storage_bucket.k8s_manifests","google_storage_bucket_object.k8s_manifests","random_id.app_key","random_id.bucket_suffix","random_password.db_password","random_password.k3s_token"]}]},{"mode":"managed","type":"random_id","name":"app_key","provider":"provider[\"registry.opentofu.org/hashicorp/random\"]","instances":[{"schema_version":0,"attributes":{"b64_std":"VNRy0fHmn3v63I9cJmt1dhatZOTut+d/9J7vYixfelw=","b64_url":"VNRy0fHmn3v63I9cJmt1dhatZOTut-d_9J7vYixfelw","byte_length":32,"dec":"38369643317914916745538282761825261291971812439741118702302634096510734662236","hex":"54d472d1f1e69f7bfadc8f5c266b757616ad64e4eeb7e77ff49eef622c5f7a5c","id":"VNRy0fHmn3v63I9cJmt1dhatZOTut-d_9J7vYixfelw","keepers":null,"prefix":null},"sensitive_attributes":[],"create_before_destroy":true}]},{"mode":"managed","type":"random_id","name":"bucket_suffix","provider":"provider[\"registry.opentofu.org/hashicorp/random\"]","instances":[{"schema_version":0,"attributes":{"b64_std":"kXWtVw==","b64_url":"kXWtVw","byte_length":4,"dec":"2440408407","hex":"9175ad57","id":"kXWtVw","keepers":null,"prefix":null},"sensitive_attributes":[],"create_before_destroy":true}]},{"mode":"managed","type":"random_password","name":"db_password","provider":"provider[\"registry.opentofu.org/hashicorp/random\"]","instances":[{"schema_version":3,"attributes":{"bcrypt_hash":"$2a$10$Tq5VQ4pOZeKa6HOT5do3POMArSllIRiAdUne4mWYayKBA8HqgaKJy","id":"none","keepers":null,"length":24,"lower":true,"min_lower":0,"min_numeric":0,"min_special":0,"min_upper":0,"number":true,"numeric":true,"override_special":null,"result":"_2K1_KB#(E2gb!C)gRpR@\u0026@D","special":true,"upper":true},"sensitive_attributes":[[{"type":"get_attr","value":"result"}],[{"type":"get_attr","value":"bcrypt_hash"}]],"create_before_destroy":true}]},{"mode":"managed","type":"random_password","name":"k3s_token","provider":"provider[\"registry.opentofu.org/hashicorp/random\"]","instances":[{"schema_version":3,"attributes":{"bcrypt_hash":"$2a$10$QeN3xYQ6QSMa3IOVrJ8YfutxZOArlvrxBZ82s1gtZJgISJFOW/xQW","id":"none","keepers":null,"length":64,"lower":true,"min_lower":0,"min_numeric":0,"min_special":0,"min_upper":0,"number":true,"numeric":true,"override_special":null,"result":"lxp5Mrvr473HEeEVFePEIfYCDXvkQ1gaIQbhWL8zlfDo6qBzraH2l2d06sSgOiQ4","special":false,"upper":true},"sensitive_attributes":[[{"type":"get_attr","value":"bcrypt_hash"}],[{"type":"get_attr","value":"result"}]],"create_before_destroy":true}]}],"check_results":null}
